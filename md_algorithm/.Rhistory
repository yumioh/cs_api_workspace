#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "월별 barplot",
ylim = c(0,65000),
ylab = "빈도",
xlab = "월별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
gh_freq <- table(gh_data$월별)
kosha_freq <- table(kosha_data$월별)
# 비사고 데이터와 사고 데이터에서 발생한 고유한 발생시간 값을 중복 없이, 오름차순으로 정렬한 값
# sort : 정렬 unique : 중복된 값 제거
# 발생시간의 모든 범위 확보
all_times <- sort(unique(c(names(gh_freq), names(kosha_freq))))
# gh_freq와 kosha_freq 모두에 대해 발생시간 범위를 일치시키기 위해 0으로 채워줌
gh_freq_full <- rep(0, length(all_times))
#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "월별 barplot",
ylim = c(0,10000),
ylab = "빈도",
xlab = "월별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
axis(1, at=colMeans(bp), labels=c("1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"), cex.axis = 0.8)
#histgram 그리기 plot = FALSE는 histogram을 그리지 않고 데이터만 계산
gh_hist = hist(gh_data$요일별, plot = FALSE)
kosha_hist = hist(kosha_data$요일별, plot = FALSE)
#ylim : y축 범위, adjustcolor : 불투명도
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,10000), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram")
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,65000), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram")
#ylim : y축 범위, adjustcolor : 불투명도
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,20000), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,15000), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram")
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,15000),  ylab="빈도", xlab="", main = "요일별 histogram")
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1), ylim=c(0,15000),  ylab="빈도", xlab="", main = "요일별 histogram")
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),  xaxt = "n", add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),
xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),xaxt = "n", add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),xaxt = "n", add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n")
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE,xlim=c(0.5, 6.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE,xlim=c(0.5, 6.5))
plot(gh_hist$mids - 0.1, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, 15000), ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 히스토그램 그리기 (막대 위치를 약간 이동)
lines(kosha_hist$mids + 0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 범례 추가
legend("topright", legend=c("비사고 데이터", "사고 데이터"),
fill=c("#F2E64D", "#19396d"), cex = 0.8)
plot(gh_hist$mids-0.1, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist$mids+0.1, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(gh_hist,gh_hist$mids-0.1, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist, gh_hist$mids-0.1, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist$mids - 0.1, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, 15000), ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 히스토그램 그리기 (막대 위치를 약간 이동)
lines(kosha_hist$mids + 0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 범례 추가
legend("topright", legend=c("비사고 데이터", "사고 데이터"),
fill=c("#F2E64D", "#19396d"), cex = 0.8)
#ylim : y축 범위, adjustcolor : 불투명도
plot(gh_hist, gh_hist$mids, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist$mids, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, 15000), ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 히스토그램 그리기 (막대 위치를 약간 이동)
lines(kosha_hist$mids + 0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 범례 추가
legend("topright", legend=c("비사고 데이터", "사고 데이터"),
fill=c("#F2E64D", "#19396d"), cex = 0.8)
plot(gh_hist$mids, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, 15000), ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 히스토그램 그리기 (막대 위치를 약간 이동)
lines(kosha_hist$mids, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 범례 추가
legend("topright", legend=c("비사고 데이터", "사고 데이터"),
fill=c("#F2E64D", "#19396d"), cex = 0.8)
plot(gh_hist$counts,gh_hist$mids-0.1, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist$counts, gh_hist$mids-0.1, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist$counts, col=adjustcolor("#F2E64D", alpha=0.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
hist(gh_data$요일별, plot = FALSE)
hist(gh_data$요일별, plot = FALSE)
hist(gh_data$공사규모, plot = FALSE)
hist(kosha_data$요일별, plot = FALSE)
hist(gh_data$요일별, plot = FALSE)
hist(kosha_data$요일별, plot = FALSE)
breaks <- seq(1, 7, by=0.5)
gh_hist = hist(gh_data$요일별, breaks=breaks, plot = FALSE)
kosha_hist = hist(kosha_data$요일별,breaks=breaks, plot = FALSE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000), add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), xaxt = "n")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000),xlim=c(0.5, 6.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(0.5, 6.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(0, 6.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 6.5))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 1))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7))
gh_hist = hist(gh_data$요일별,plot = FALSE)
kosha_hist = hist(kosha_data$요일별,plot = FALSE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
par(mgp = c(3, 1.5, 0))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
mtext("요일", side=1, line=2.5, at=mean(range(gh_hist$breaks)), cex=1)
source("C:/workplace/csi_api_workspace/md_algorithm/r_visualization/visualization_boxplot.R", echo=TRUE)
mtext("요일", side=1, line=2.5, at=mean(c(1,7)), cex=1)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
#histgram 그리기 plot = FALSE는 histogram을 그리지 않고 데이터만 계산
gh_hist = hist(gh_data$요일별,plot = FALSE)
kosha_hist = hist(kosha_data$요일별,plot = FALSE)
#ylim : y축 범위, adjustcolor : 불투명도
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
# 범례 추가 cex: FONT SIZE, toright : 범례 위치
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
mtext("요일", side=1, line=2.5, at=mean(c(1,7)), cex=1)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add = TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add = TRUE)
# 비사고 데이터 히스토그램 생성
gh_hist = hist(gh_data$요일별, breaks=breaks, plot = FALSE)
# 히스토그램 그리기
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),
ylim=c(0, 150000),  # y축 범위
xlim=c(0.5, 6.5),  # x축 범위 설정하여 1, 2번 간격 유지
ylab="빈도", xlab="", main="요일별 히스토그램")  # xlab을 빈 문자열로 설정
plot(gh_hist$mids, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, 15000), ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 히스토그램 그리기 (막대 위치를 약간 이동)
lines(kosha_hist$mids, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 범례 추가
legend("topright", legend=c("비사고 데이터", "사고 데이터"),
fill=c("#F2E64D", "#19396d"), cex = 0.8)
# 비사고 데이터 먼저 그리기
plot(gh_hist$mids - 0.1, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids + 0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
plot(gh_hist$mids, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
lines(kosha_hist$mids-1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids-0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
plot(gh_hist$mids, gh_hist$counts, type="h",
lwd=10, col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids-0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
plot(gh_hist$mids, gh_hist$counts, type="h",
col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
plot(gh_hist$mids, gh_hist$counts,
col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids-0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
plot(gh_hist$mids, gh_hist$counts, type="h",
col=adjustcolor("#F2E64D", alpha=0.5),
xlim=c(0.5, 6.5), ylim=c(0, max(gh_hist$counts, kosha_hist$counts)),
ylab="빈도", xlab="요일", main="요일별 사고/비사고 히스토그램")
# 사고 데이터 나란히 그리기 (막대를 오른쪽으로 조금 이동)
lines(kosha_hist$mids-0.1, kosha_hist$counts, type="h",
lwd=10, col=adjustcolor("#19396d", alpha=0.7))
par(mfrow = c(1, 2))
# 첫 번째 히스토그램 그래프
plot(gh_hist, main="GH Data 요일별", xlab="요일", ylab="빈도", col="blue")
# 두 번째 히스토그램 그래프
plot(kosha_hist, main="KOSHA Data 요일별", xlab="요일", ylab="빈도", col="red")
# 원래 레이아웃으로 복구
par(mfrow = c(1, 1))
plot(kosha_hist, main="KOSHA Data 요일별", xlim=c(0, 3),xlab="요일", ylab="빈도", col="red")
plot(kosha_hist, main="KOSHA Data 요일별", xlim=c(0, 7),xlab="요일", ylab="빈도", col="red")
plot(kosha_hist, main="KOSHA Data 요일별", xlim=c(1, 7),xlab="요일", ylab="빈도", col="red")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 8))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add="TRUE")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add=TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 15000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add=TRUE)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
gh_freq <- table(gh_data$요일별)
kosha_freq <- table(kosha_data$요일별)
# 비사고 데이터와 사고 데이터에서 발생한 고유한 발생시간 값을 중복 없이, 오름차순으로 정렬한 값
# sort : 정렬 unique : 중복된 값 제거
# 발생시간의 모든 범위 확보
all_times <- sort(unique(c(names(gh_freq), names(kosha_freq))))
# gh_freq와 kosha_freq 모두에 대해 발생시간 범위를 일치시키기 위해 0으로 채워줌
gh_freq_full <- rep(0, length(all_times))
#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "월별 barplot",
ylim = c(0,10000),
ylab = "빈도",
xlab = "월별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
axis(1, at=colMeans(bp), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "월별 barplot",
ylim = c(0,15000),
ylab = "빈도",
xlab = "요일별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
axis(1, at=colMeans(bp), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "월별 barplot",
ylim = c(0,15000),
ylab = "빈도",
xlab = "요일별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
# 비사고 데이터와 사고 데이터의 발생시간 값 빈도 계산
gh_freq <- table(gh_data$요일별)
kosha_freq <- table(kosha_data$요일별)
# 비사고 데이터와 사고 데이터에서 발생한 고유한 발생시간 값을 중복 없이, 오름차순으로 정렬한 값
# sort : 정렬 unique : 중복된 값 제거
# 발생시간의 모든 범위 확보
all_times <- sort(unique(c(names(gh_freq), names(kosha_freq))))
# gh_freq와 kosha_freq 모두에 대해 발생시간 범위를 일치시키기 위해 0으로 채워줌
gh_freq_full <- rep(0, length(all_times))
#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "요일별 barplot",
ylim = c(0,15000),
ylab = "빈도",
xlab = "요일별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
#요일별 x축 레이블 추가
axis(1, at=colMeans(bp), labels=c("월","화","수","목","금","토","일"), cex.axis = 0.8)
# 비사고 데이터와 사고 데이터의 발생시간 값 빈도 계산
gh_freq <- table(gh_data$나이)
kosha_freq <- table(kosha_data$나이)
# 비사고 데이터와 사고 데이터에서 발생한 고유한 발생시간 값을 중복 없이, 오름차순으로 정렬한 값
# sort : 정렬 unique : 중복된 값 제거
# 발생시간의 모든 범위 확보
all_times <- sort(unique(c(names(gh_freq), names(kosha_freq))))
# gh_freq와 kosha_freq 모두에 대해 발생시간 범위를 일치시키기 위해 0으로 채워줌
gh_freq_full <- rep(0, length(all_times))
#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "나이별 barplot",
ylim = c(0,15000),
ylab = "빈도",
xlab = "나이별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
gh_freq <- table(gh_data$나이)
kosha_freq <- table(kosha_data$나이)
# 비사고 데이터와 사고 데이터에서 발생한 고유한 발생시간 값을 중복 없이, 오름차순으로 정렬한 값
# sort : 정렬 unique : 중복된 값 제거
# 발생시간의 모든 범위 확보
all_times <- sort(unique(c(names(gh_freq), names(kosha_freq))))
# gh_freq와 kosha_freq 모두에 대해 발생시간 범위를 일치시키기 위해 0으로 채워줌
gh_freq_full <- rep(0, length(all_times))
#벡터에 이름 부여
names(gh_freq_full) <- all_times
#실제 빈도의 값 이름에 맞춰서 채우기
gh_freq_full[names(gh_freq)] <- gh_freq
kosha_freq_full <- rep(0, length(all_times))
names(kosha_freq_full) <- all_times
kosha_freq_full[names(kosha_freq)] <- kosha_freq
# 두 데이터를 나란히 결합
combined_data <- rbind(gh_freq_full, kosha_freq_full)
# 두 데이터를 나란히 그리기
bp <- barplot(combined_data,
beside = TRUE,                    # 막대를 나란히 배치
col = c("#F2E64D", "#19396d"),    # 각각의 색상 지정
main = "나이별 barplot",
ylim = c(0,50000),
ylab = "빈도",
xlab = "나이별",
xaxt = "n") #x축 레이블 없애기
# 범례 추가
legend("topright",
legend = c("비사고 데이터", "사고 데이터"),
fill = c("#F2E64D", "#19396d"),
cex = 0.8)
axis(1, at=colMeans(bp), labels=c("18세미만","19~24세이하","25~29세이하","30~34세이하","35~39세이하","40~44세이하","45~49세이하","50~54세이하","55~59세이하","60세이상"), cex.axis = 0.8)
gh_hist = hist(gh_data$발생시간,plot = FALSE)
kosha_hist = hist(kosha_data$발생시간,plot = FALSE)
#ylim : y축 범위, adjustcolor : 불투명도
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add=TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xlim=c(1, 7), add=TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), add=TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("0~6시","6~8시","8~12시","12~13시","13~18시","18~21시","21~24시"), cex.axis = 0.8)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000), xlim = c(1,2,3,4,5,6,7))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), xlim = c(1,2,3,4,5,6,7) xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5), breaks = c(1,2,3,4,5,6,7), xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
gh_hist = hist(gh_data$발생시간, breaks = c(1,2,3,4,5,6,7), plot = FALSE)
gh_hist = hist(gh_data$발생시간,breaks=breaks plot = FALSE)
gh_hist = hist(gh_data$발생시간,breaks=breaks, plot = FALSE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 55000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", ylab="빈도", xlab="", main = "요일별 histogram", ylim=c(0, 65000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("0~6시","6~8시","8~12시","12~13시","13~18시","18~21시","21~24시"), cex.axis = 0.8)
# 범례 추가 cex: FONT SIZE, toright : 범례 위치
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", ylab="빈도", xlab="", main = "발생시간 histogram", ylim=c(0, 65000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
# 범례 추가 cex: FONT SIZE, toright : 범례 위치
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("0~6시","6~8시","8~12시","12~13시","13~18시","18~21시","21~24시"), cex.axis = 0.8)
gh_hist = hist(gh_data$근무경력, plot = FALSE)
kosha_hist = hist(kosha_data$근무경력,plot = FALSE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", ylab="빈도", xlab="", main = "근무경력 histogram", ylim=c(0, 65000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("1년미만","1~2년미만","2~3년미만","3~4년미만","4~5년미만","5~10년미만","10년이상"), cex.axis = 0.8)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.5),xaxt = "n", ylab="빈도", xlab="", main = "근무경력 histogram", ylim=c(0, 65000),add=TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),xaxt = "n", ylab="빈도", xlab="", main = "근무경력 histogram", ylim=c(0, 65000),add=TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7, xlab="", main = "근무경력 histogram",  ylab="빈도"))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "근무경력 histogram",  ylab="빈도")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),xaxt = "n",ylim=c(0, 65000),add=TRUE)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("1년미만","1~2년미만","2~3년미만","3~4년미만","4~5년미만","5~10년미만","10년이상"), cex.axis = 0.8)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "근무경력 histogram",  ylab="빈도",xaxt = "n")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),ylim=c(0, 65000),add=TRUE)
axis(1, at = c(1,2,3,4,5,6,7), labels=c("1년미만","1~2년미만","2~3년미만","3~4년미만","4~5년미만","5~10년미만","10년이상"), cex.axis = 0.8)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
gh_hist = hist(gh_data$공사규모, breaks=breaks, plot = FALSE)
gh_hist = hist(gh_data$공사규모, breaks=breaks, plot = FALSE)
kosha_hist = hist(kosha_data$공사규모,plot = FALSE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),ylim=c(0, 65000),add=TRUE)
#공사규모 x축 레이블 추가
axis(1, at = c(1,2,3,4), labels=c("9명이하","10~99명이하","100~499명이하","500명이상"), cex.axis = 0.8)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n")
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),ylim=c(0, 65000),add=TRUE)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n",ylim=c(0, 65000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=1),add=TRUE)
axis(1, at = c(1,2,3,4), labels=c("9명이하","10~99명이하","100~499명이하","500명이상"), cex.axis = 0.8)
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n",ylim=c(0, 65000))
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.9),add=TRUE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.9), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n",ylim=c(0, 65000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
axis(1, at = c(1,2,3,4), labels=c("9명이하","10~99명이하","100~499명이하","500명이상"), cex.axis = 0.8)
gh_hist = hist(gh_data$공사규모,plot = FALSE)
kosha_hist = hist(kosha_data$공사규모,plot = FALSE)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.9), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n",ylim=c(0, 65000))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
legend("topright",legend=c("비사고데이터","사고데이터터"),fill=c("#F2E64D","#19396d"),cex = 0.8)
axis(1, at = c(1,2,3,4), labels=c("9명이하","10~99명이하","100~499명이하","500명이상"), cex.axis = 0.8)
plot(gh_hist, col=adjustcolor("#F2E64D", alpha=0.9), xlab="", main = "공사규모 histogram",  ylab="빈도",xaxt = "n",ylim=c(0, 65000), xlim=c(1,4))
plot(kosha_hist, col=adjustcolor("#19396d", alpha=0.7),add=TRUE)
axis(1, at = c(1,2,3,4), labels=c("9명이하","10~99명이하","100~499명이하","500명이상"), cex.axis = 0.8)
box <- boxplot(gh_data$나이, kosha_data$나이, names = c("비사고데이터", "사고데이터"), main = "나이 BOXPLOT", col = c("#F2E64D","#19396d"))
text(x = c(1.5, 2.5), y = box_stats[1,], labels = round(box_stats[1,], 2), col = "Red", cex = 0.9, font=2)
text(x = c(1.5, 2.5), y = box_stats[2,], labels = round(box_stats[2,], 2), col = "Red", cex = 0.9, font=2)
text(x = c(1.5, 2.5), y = box_stats[3,], labels = round(box_stats[3,], 2), col = "Red", cex = 0.9, font=2)
text(x = c(1.5, 2.5), y = box_stats[4,], labels = round(box_stats[4,], 2), col = "Red", cex = 0.9, font=2)
text(x = c(1.5, 2.3), y = box_stats[5,], labels = round(box_stats[5,], 2), col = "Red", cex = 0.9, font=2)
#default 경로 설정
setwd("C:/workplace/csi_api_workspace/md_algorithm/")
getwd()
install.packages()
#카테고리한 gh data 불려오기
gh_data = read.csv("./data/gh_categorize.csv")
kosha_data = read.csv("./data/kosha_categorize.csv")
